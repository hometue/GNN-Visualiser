(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9219:function(e,t,a){Promise.resolve().then(a.bind(a,6017))},6017:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var n=a(7437),r=a(2265),s=a(6739),l=a.n(s);function d(e){let t=(0,r.useRef)(null),a=(0,r.useRef)(null),s=(0,r.useRef)(l()());return(0,r.useEffect)(()=>{var n;let r=a.current;if(null===r||(n=e.graph.data.adjMatrix,!(r.length===n.length&&r.every((e,t)=>e.length===n[t].length&&e.every((e,a)=>e===n[t][a]))))){let n=l()({container:t.current,elements:function(e){let t=[];return e.adjMatrix.forEach((a,n)=>{let r={data:{id:n.toString(),embedding:e.nodeFeatures[n]}};t.push(r),a.forEach((e,a)=>{if(0!=e){let e={data:{id:n.toString().concat("e".concat(a.toString())),source:n.toString(),target:a.toString()}};t.push(e)}})}),t}(e.graph.data),layout:{name:"circle"},style:[{selector:"node",style:{label:e=>"ID: "+e.data("id")+"\nE:"+e.data("embedding"),"text-wrap":"wrap"}},{selector:"edge",style:{"curve-style":"bezier","target-arrow-shape":"triangle"}}]});null!==e.graph.data.selectedNode&&n.$("#".concat(e.graph.data.selectedNode.toString())).select(),n.fit();let r=()=>{n.resize(),n.fit()};return n.on("select",t=>{let a=e.graph.data.cloneGraph();a.selectedNode=parseInt(t.target.data("id")),e.graph.setData(a)}),n.on("unselect",()=>{let t=e.graph.data.cloneGraph();t.selectedNode=null,e.graph.setData(t)}),window.addEventListener("resize",r),a.current=e.graph.data.adjMatrix.map(e=>[...e]),s.current=n,()=>{window.removeEventListener("resize",r)}}},[e.graph]),(0,n.jsx)("div",{style:{width:"100%",height:"100%"},ref:t})}var i=a(9139),o=a(5996),c=a(4272),u=a(4372),h=a(815),g=a(7496);function p(e){let t=(0,r.useRef)(null);return(0,r.useEffect)(()=>{function a(a){t.current&&!t.current.contains(a.target)&&e.onEndEdit()}return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[e]),(0,n.jsx)("input",{type:"number",value:e.value,onChange:e.onChange,ref:t})}function f(e){let[t,a]=(0,r.useState)(null);if(null===t)return(0,n.jsxs)("span",{onClick:t=>{a(e.cellValue)},children:[e.cellValue.toString(),"\xa0"]});{let r=e=>{let t=parseInt(e);return isNaN(t)?0:t};return(0,n.jsx)(p,{value:t,onChange:e=>{a(r(e.target.value))},onEndEdit:()=>{null!==t&&e.updateGraph(t),a(null)}})}}function x(e){let[t,a]=(0,r.useState)(!1),s={};s=t||e.selected?{backgroundColor:"WhiteSmoke"}:{backgroundColor:"white"};let l=t=>a=>{e.updateGraph(t,a)};return(0,n.jsx)("div",{style:s,onMouseLeave:e=>{a(!1)},onMouseOver:e=>{a(!0)},children:e.row.map((e,t)=>(0,n.jsx)(f,{cellValue:e,updateGraph:l(t)},t))})}function j(e){let t=t=>(a,n)=>{let r=e.graph.data.cloneGraph();r.adjMatrix[t][a]=n,e.graph.setData(r)};return(0,n.jsx)(i.Z,{style:{display:"inline-block"},variant:"outlined",children:(0,n.jsxs)(o.Z,{children:[(0,n.jsx)("div",{children:"Adj matrix. Edit by clicking on value then pressing enter or clicking away."}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(u.Z,{onClick:()=>{let t=e.graph.data.cloneGraph();t.removeNode(t.adjMatrix.length-1),e.graph.setData(t)},children:(0,n.jsx)(g.Z,{fontSize:"small"})}),(0,n.jsx)(u.Z,{onClick:()=>{let t=e.graph.data.cloneGraph();t.addNode(),e.graph.setData(t)},children:(0,n.jsx)(h.Z,{fontSize:"small"})})]}),(0,n.jsx)(c.Z,{width:"fit-content",children:e.graph.data.adjMatrix.map((a,r)=>(0,n.jsx)(x,{row:a,updateGraph:t(r),selected:r===e.graph.data.selectedNode},r))}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)("div",{children:"Node embedding:"}),e.graph.data.nodeFeatures.map(e=>(0,n.jsxs)(n.Fragment,{children:[e," "]}))]})]})})}class m{addNode(){this.adjMatrix.forEach(e=>{e.push(0)});let e=Array(this.adjMatrix.length+1);e.fill(0,0,this.adjMatrix.length+1),e[this.adjMatrix.length]=1,this.adjMatrix.push(e),this.nodeFeatures.push(this.numberOfNodes())}removeNode(e){e>=this.numberOfNodes()||(this.adjMatrix.splice(e,1),this.adjMatrix.forEach(t=>{t.splice(e,1)}))}numberOfNodes(){return this.adjMatrix.length}printNodes(){console.log(this.adjMatrix)}getNeighbours(e){if(e>=this.adjMatrix.length)return[];let t=0,a=[];for(;t<this.numberOfNodes();)0!==this.adjMatrix[t][e]&&a.push(t),t+=1;return a}cloneGraph(){let e=new m;return e.adjMatrix=this.adjMatrix,e.nodeFeatures=this.nodeFeatures,e.selectedNode=this.selectedNode,e}setNodeFeature(e,t){e<this.nodeFeatures.length&&(this.nodeFeatures[e]=t)}setNodesConnection(e,t){}adjMatrixToString(){let e="[";return this.adjMatrix.forEach((t,a)=>{0!=a&&(e=e.concat(",")),e=e.concat("[",t.toString(),"]")}),e=e.concat("]")}constructor(){this.adjMatrix=[],this.nodeFeatures=[],this.selectedNode=null}}class v{constructor(){this.finalEmbeddings=[],this.layerResult=[]}}class b{constructor(){this.weight=1,this.constant=0}}class w{static templateGraph(){let e=new w;e.nodes.push(new b);let t=new b;t.weight=2,t.constant=3,e.nodes.push(t);let a=new b;return t.weight=5,t.constant=7,e.nodes.push(a),e}message(e,t){return e*t.weight+t.constant}aggregate(e,t,a){let n=t.getNeighbours(e),r=0,s=0;return n.forEach(e=>{r+=a[e],s+=1}),r/s}calculateLayerOutput(e,t,a){let n=t.map(e=>this.message(e,a)),r=0,s=[];for(;r<e.adjMatrix.length;)s[r]=this.aggregate(r,e,n),r+=1;return{message:n,embedding:s}}getEmbeddings(e){let t=new v,a=e.nodeFeatures;return this.nodes.forEach(n=>{let r=this.calculateLayerOutput(e,a,n);t.layerResult.push(r),a=r.embedding}),t.finalEmbeddings=a,t}constructor(){this.nodes=[]}}function y(e){let t=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let a=l()({container:t.current,elements:function(e){let t=[];return e.nodes.forEach((e,a)=>{let n={data:{id:a.toString(),weight:e.weight,constant:e.constant}};if(t.push(n),0!==a){let e={data:{id:a.toString().concat("e".concat(a.toString())),source:(a-1).toString(),target:a.toString()},selectable:!1};t.push(e)}}),t}(e.gnn),layout:{name:"grid",rows:1},userPanningEnabled:!1,userZoomingEnabled:!1,boxSelectionEnabled:!1,autoungrabify:!0,style:[{selector:"node",style:{label:e=>"ID: "+e.data("id")+"\nWeight: "+e.data("weight")+"\nConstant: "+e.data("constant"),"text-wrap":"wrap",shape:"rectangle"}},{selector:"edge",style:{"curve-style":"bezier","target-arrow-shape":"triangle"}}]});a.fit(),void 0!==e.selectedNode&&null!==e.selectedNode.data&&a.$("#".concat(e.selectedNode.data.toString())).select(),void 0!==e.selectedNode&&(a.on("select",t=>{var a;null===(a=e.selectedNode)||void 0===a||a.setData(parseInt(t.target.data("id")))}),a.on("unselect",()=>{var t;null===(t=e.selectedNode)||void 0===t||t.setData(null)}))},[e.gnn,e.selectedNode]),(0,n.jsx)("div",{style:{width:"100%",height:"100%"},ref:t})}function N(){let[e,t]=(0,r.useState)(()=>{let e=new m;return e.addNode(),e.addNode(),e}),[a,s]=(0,r.useState)(w.templateGraph()),[l,i]=(0,r.useState)(null),o=a.getEmbeddings(e);return(0,n.jsxs)("div",{style:{display:"flex",height:"80vh",overflow:"auto"},children:[(0,n.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"column",height:"100%"},children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)(j,{graph:{data:e,setData:t}}),(0,n.jsxs)("div",{children:["Final embeddings: ",o.finalEmbeddings.toString()]}),null!==l?(0,n.jsxs)(n.Fragment,{children:["Messages sent from nodes at layer ",l,(0,n.jsx)("div",{children:o.layerResult[l].message.toString()})]}):null,null!==l?(0,n.jsxs)(n.Fragment,{children:["Embeddings of nodes after layer ",l,(0,n.jsx)("div",{children:o.layerResult[l].embedding.toString()})]}):null]}),(0,n.jsx)("div",{style:{flex:1},children:(0,n.jsx)(y,{gnn:a,selectedNode:{data:l,setData:i}})})]}),(0,n.jsx)("div",{style:{flex:1},children:(0,n.jsx)(d,{graph:{data:e,setData:t}})})]})}}},function(e){e.O(0,[976,27,971,69,744],function(){return e(e.s=9219)}),_N_E=e.O()}]);